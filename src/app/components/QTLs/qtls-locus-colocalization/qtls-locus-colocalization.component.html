<div class="locus-colocalization-result-tab">

  <div class="row p-3 justify-content-center">

    <!-- Toggle Spearman/Pearson correlation type -->
    <div class="col-md-auto pl-3 pr-3">
      Pearson/Spearman:
      <mat-button-toggle-group 
        name="fontStyle" 
        aria-label="Font Style" 
        [(ngModel)]="selectedCorrelation" 
        (change)="triggerCorrelationReplot()">
        <mat-button-toggle value="R">R</mat-button-toggle>
        <mat-button-toggle value="P">P</mat-button-toggle>
      </mat-button-toggle-group>
    </div>

    <!-- P-value threshold input for correlation scatter plot -->
    <div 
      class="col-md-auto pl-3 pr-3" 
      id="qtls-locus-colocalization-correlation-scatter-threshold"
      *ngIf="correlationScatter">
      <form [formGroup]="correlationScatterThreshold">
        <mat-form-field class="correlation-pval-threshold-input-field">
          <input 
            #correlationPvalThreshold
            matInput 
            placeholder="P-value Threshold" 
            (keyup)="changeCorrelationPvalThreshold($event)" 
            [(ngModel)]="selectedCorrelationPvalThreshold" 
            formControlName="correlationPvalThreshold">
          <button 
            mat-button matSuffix mat-icon-button aria-label="Clear" 
            (click)="clearCorrelationPvalThreshold()" 
            [disabled]="selectedCorrelation == 'R'">
            <mat-icon>close</mat-icon>
          </button>
          <mat-error *ngIf="correlationScatterThreshold.invalid">{{ correlationPvalThresholdErrorMsg() }}</mat-error>
        </mat-form-field>
      </form>
    </div>
    
  </div>

  <!-- Show centered Plotly locus colocalization scatter plot if graph is generated -->
  <div 
    class="d-flex justify-content-center" 
    id="qtls-locus-colocalization-correlation-scatter-plot">
    <plotly-plot 
      *ngIf="correlationScatter"
      [data]="correlationScatter.data" 
      [layout]="correlationScatter.layout" 
      [config]="correlationScatter.config">
    </plotly-plot>
  </div>

  <br>

  <h3 class="mr-3">eCAVIAR</h3>

  <!-- eCAVIAR results table -->
  <div class="ecaviar-results pt-2 border border-light rounded" style="background: #E8E8E8 !important;">
    <!-- table filter input field -->
    <div class="ml-2 mr-2">
      <mat-form-field>
        <input matInput 
          [disabled]="!showECAVIARTable"
          (keyup)="applyFilterECAVIAR($event.target.value)" 
          placeholder="Filter">
      </mat-form-field>
    </div>
    <!-- loading spinner -->
    <div 
      class="d-flex justify-content-center" 
      *ngIf="!showECAVIARTable && !ecaviarWarningMessage">
      <mat-spinner></mat-spinner>
    </div>
    <!-- show warning message if no eCAVIAR data is returned -->
    <div 
      id="ecaviar-warning"
      class="ml-2 mr-2 alert alert-warning show text-center" 
      role="alert"  
      *ngIf="ecaviarWarningMessage">
      No eCAVIAR calculation results. Please check input data files and calculation parameters.
    </div>
    <!-- x-scrollable table container -->
    <div class="ml-2 mr-2 ecaviar-details-table-container" *ngIf="showECAVIARTable">
      <table class="ecaviar-details-table" mat-table [dataSource]="dataSourceECAVIAR" #ECAVIARSort="matSort" matSort matSortStart="desc">
        <!--- Note that these columns can be defined in any order.
              The actual rendered columns are set as a property on the row definition" -->

        <!-- gene_id Column -->
        <ng-container matColumnDef="gene_id">
          <th mat-header-cell *matHeaderCellDef> Gene ID </th>
          <td mat-cell *matCellDef="let ecaviar">{{ecaviar.gene_id}}</td>
        </ng-container>
      
        <!-- gene_symbol Column -->
        <ng-container matColumnDef="gene_symbol">
          <th mat-header-cell *matHeaderCellDef> Gene Symbol </th>
          <td mat-cell *matCellDef="let ecaviar">{{ecaviar.gene_symbol}}</td>
        </ng-container>
      
        <!-- variant_id Column -->
        <!-- <ng-container matColumnDef="variant_id">
          <th mat-header-cell *matHeaderCellDef mat-sort-header="variant_id"> Variant ID </th>
          <td mat-cell *matCellDef="let ecaviar">{{ecaviar.variant_id}}</td>
        </ng-container> -->
      
        <!-- rsnum Column -->
        <ng-container matColumnDef="rsnum">
          <th mat-header-cell *matHeaderCellDef> RS Number </th>
          <td mat-cell *matCellDef="let ecaviar">{{ecaviar.rsnum}}</td>
        </ng-container>
      
        <!-- chr Column -->
        <ng-container matColumnDef="chr">
          <th mat-header-cell *matHeaderCellDef> Chromosome </th>
          <td mat-cell *matCellDef="let ecaviar"> {{ecaviar.chr}} </td>
        </ng-container>
      
        <!-- pos Column -->
        <ng-container matColumnDef="pos">
          <th mat-header-cell *matHeaderCellDef> Position </th>
          <td mat-cell *matCellDef="let ecaviar"> {{ecaviar.pos}} </td>
        </ng-container>
      
        <!-- ref Column -->
        <ng-container matColumnDef="ref">
          <th mat-header-cell *matHeaderCellDef> Ref </th>
          <td mat-cell *matCellDef="let ecaviar"> {{ecaviar.ref}} </td>
        </ng-container>
      
        <!-- alt Column -->
        <ng-container matColumnDef="alt">
          <th mat-header-cell *matHeaderCellDef> Alt </th>
          <td mat-cell *matCellDef="let ecaviar"> {{ecaviar.alt}} </td>
        </ng-container>
      
        <!-- tss_distance Column -->
        <ng-container matColumnDef="tss_distance">
          <th mat-header-cell *matHeaderCellDef> TSS Distance </th>
          <td mat-cell *matCellDef="let ecaviar"> {{ecaviar.tss_distance}} </td>
        </ng-container>
      
        <!-- pval_nominal Column -->
        <ng-container matColumnDef="pval_nominal">
          <th mat-header-cell *matHeaderCellDef>Nomimal P-value</th>
          <td mat-cell *matCellDef="let ecaviar"> {{ecaviar.pval_nominal}} </td>
        </ng-container>
      
        <!-- slope Column -->
        <ng-container matColumnDef="slope">
          <th mat-header-cell *matHeaderCellDef> Slope </th>
          <td mat-cell *matCellDef="let ecaviar"> {{ecaviar.slope}} </td>
        </ng-container>
      
        <!-- slope_se Column -->
        <ng-container matColumnDef="slope_se">
          <th mat-header-cell *matHeaderCellDef> Slope SE </th>
          <td mat-cell *matCellDef="let ecaviar"> {{ecaviar.slope_se}} </td>
        </ng-container>
        
        <!-- gwas_pvalue Column -->
        <ng-container matColumnDef="gwas_pvalue">
          <th mat-header-cell *matHeaderCellDef> GWAS P-value </th>
          <td mat-cell *matCellDef="let ecaviar"> {{ecaviar.gwas_pvalue}} </td>
        </ng-container>
    
        <!-- gwas_z Column -->
        <ng-container matColumnDef="gwas_z">
          <th mat-header-cell *matHeaderCellDef> GWAS Z </th>
          <td mat-cell *matCellDef="let ecaviar"> {{ecaviar.gwas_z}} </td>
        </ng-container>
    
        <!-- Leadsnp Column -->
        <ng-container matColumnDef="Leadsnp">
          <th mat-header-cell *matHeaderCellDef> Lead SNP </th>
          <td mat-cell *matCellDef="let ecaviar"> {{ecaviar.Leadsnp}} </td>
        </ng-container>
        
        <!-- Prob_in_pCausalSet Column -->
        <ng-container matColumnDef="Prob_in_pCausalSet">
          <th mat-header-cell *matHeaderCellDef> Prob_in_pCausalSet </th>
          <td mat-cell *matCellDef="let ecaviar"> {{ecaviar.Prob_in_pCausalSet}} </td>
        </ng-container>
    
        <!-- CLPP Column -->
        <ng-container matColumnDef="CLPP">
          <th mat-header-cell *matHeaderCellDef> CLPP </th>
          <td mat-cell *matCellDef="let ecaviar"> {{ecaviar.CLPP}} </td>
        </ng-container>
    
        <!-- Prob_in_pCausalSet2 Column -->
        <ng-container matColumnDef="Prob_in_pCausalSet2">
          <th mat-header-cell *matHeaderCellDef> Prob_in_pCausalSet2 </th>
          <td mat-cell *matCellDef="let ecaviar"> {{ecaviar.Prob_in_pCausalSet2}} </td>
        </ng-container>
    
        <!-- CLPP2 Column -->
        <ng-container matColumnDef="CLPP2">
          <th mat-header-cell *matHeaderCellDef> CLPP2 </th>
          <td mat-cell *matCellDef="let ecaviar"> {{ecaviar.CLPP2}} </td>
        </ng-container>
    
        <!-- leadsnp_included Column -->
        <ng-container matColumnDef="leadsnp_included">
          <th mat-header-cell *matHeaderCellDef> Lead SNP Included </th>
          <td mat-cell *matCellDef="let ecaviar"> {{ecaviar.leadsnp_included}} </td>
        </ng-container>
      
        <tr mat-header-row *matHeaderRowDef="displayedColumnsECAVIAR" style="background: #8C97D4 !important;"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumnsECAVIAR;"></tr>
      </table>

    </div>
      
    <mat-paginator #ECAVIARPaginator [pageSizeOptions]="[10, 20, 50, 100]" showFirstLastButtons style="background: #E8E8E8 !important;"></mat-paginator>

    <!-- <mat-paginator [disabled]="!showECAVIARTable" [pageSizeOptions]="[10, 20, 50, 100]" showFirstLastButtons></mat-paginator> -->
    
    <div class="ml-4 mb-4 ecaviar-details-table" style="color: #0000EE; text-decoration: underline; cursor: pointer;">
      <a (click)="downloadECAVIARTable()" 
        *ngIf="showECAVIARTable">
        Download eCAVIAR Table
      </a>
    </div>

  </div>

  <br>

  <h3 class="mr-3">HyprColoc</h3>

  <!-- Hyprcoloc results table -->
  <div class="hyprcoloc-results pt-2 border border-light rounded" style="background: #E8E8E8 !important;">
    <!-- table filter input field -->
    <div class="ml-2 mr-2">
      <mat-form-field>
        <input matInput 
          [disabled]="!showHyprcolocTable"
          (keyup)="applyFilterHyprcoloc($event.target.value)" 
          placeholder="Filter">
      </mat-form-field>
    </div>
    <!-- loading spinner -->
    <div 
      class="d-flex justify-content-center" 
      *ngIf="!showHyprcolocTable && !hyprcolocWarningMessage">
      <mat-spinner></mat-spinner>
    </div>
    <!-- show warning message if no Hyprcoloc data is returned -->
    <div 
      id="hyprcoloc-warning"
      class="ml-2 mr-2 alert alert-warning show text-center" 
      role="alert"  
      *ngIf="hyprcolocWarningMessage">
      No Hyprcoloc calculation results. Please check input data files and calculation parameters.
    </div>
    <!-- x-scrollable table container -->
    <div class="ml-2 mr-2 hyprcoloc-details-table-container" *ngIf="showHyprcolocTable">
      <table class="hyprcoloc-details-table" mat-table [dataSource]="dataSourceHyprcoloc" matSortStart="desc">
        <!--- Note that these columns can be defined in any order.
              The actual rendered columns are set as a property on the row definition" -->

        <!-- iteration Column -->
        <ng-container matColumnDef="iteration">
          <th mat-header-cell *matHeaderCellDef> Iterations </th>
          <td mat-cell *matCellDef="let hyprcoloc">{{hyprcoloc.iteration}}</td>
        </ng-container>
      
        <!-- traits Column -->
        <ng-container matColumnDef="traits">
          <th mat-header-cell *matHeaderCellDef> Traits </th>
          <td mat-cell *matCellDef="let hyprcoloc">{{hyprcoloc.traits}}</td>
        </ng-container>
      
        <!-- posterior_prob Column -->
        <ng-container matColumnDef="posterior_prob">
          <th mat-header-cell *matHeaderCellDef> Posterior Probability </th>
          <td mat-cell *matCellDef="let hyprcoloc">{{hyprcoloc.posterior_prob}}</td>
        </ng-container>
      
        <!-- regional_prob Column -->
        <ng-container matColumnDef="regional_prob">
          <th mat-header-cell *matHeaderCellDef> Regional Probability </th>
          <td mat-cell *matCellDef="let hyprcoloc"> {{hyprcoloc.regional_prob}} </td>
        </ng-container>
      
        <!-- candidate_snp Column -->
        <ng-container matColumnDef="candidate_snp">
          <th mat-header-cell *matHeaderCellDef> Candidate SNP </th>
          <td mat-cell *matCellDef="let hyprcoloc"> {{hyprcoloc.candidate_snp}} </td>
        </ng-container>
      
        <!-- posterior_explained_by_snp Column -->
        <ng-container matColumnDef="posterior_explained_by_snp">
          <th mat-header-cell *matHeaderCellDef> Posterior Explained By SNP </th>
          <td mat-cell *matCellDef="let hyprcoloc"> {{hyprcoloc.posterior_explained_by_snp}} </td>
        </ng-container>
      
        <!-- dropped_trait Column -->
        <ng-container matColumnDef="dropped_trait">
          <th mat-header-cell *matHeaderCellDef> Dropped Trait </th>
          <td mat-cell *matCellDef="let hyprcoloc"> {{hyprcoloc.dropped_trait}} </td>
        </ng-container>
      
        <!-- gene_id Column -->
        <ng-container matColumnDef="gene_id">
          <th mat-header-cell *matHeaderCellDef> Gene ID </th>
          <td mat-cell *matCellDef="let hyprcoloc"> {{hyprcoloc.gene_id}} </td>
        </ng-container>
      
        <!-- gene_symbol Column -->
        <ng-container matColumnDef="gene_symbol">
          <th mat-header-cell *matHeaderCellDef>Gene Symbol</th>
          <td mat-cell *matCellDef="let hyprcoloc"> {{hyprcoloc.gene_symbol}} </td>
        </ng-container>
      
        <tr mat-header-row *matHeaderRowDef="displayedColumnsHyprcoloc" style="background: #8C97D4 !important;"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumnsHyprcoloc;"></tr>
      </table>

    </div>
      
    <mat-paginator #HyprcolocPaginator [pageSizeOptions]="[10, 20, 50, 100]" showFirstLastButtons style="background: #E8E8E8 !important;"></mat-paginator>
    
    <div class="ml-4 mb-4 hyprcoloc-details-table" style="color: #0000EE; text-decoration: underline; cursor: pointer;">
      <a (click)="downloadHyprcolocTable()" 
        *ngIf="showHyprcolocTable">
        Download Hyprcoloc Table
      </a>
    </div>

  </div>

  <br>

  <h3 class="mr-3">HyprColoc SNP Scores</h3>

  <!-- Hyprcoloc snpscore results table -->
  <div class="hyprcoloc-snpscore-results pt-2 border border-light rounded" style="background: #E8E8E8 !important;">
    <!-- table filter input field -->
    <div class="ml-2 mr-2">
      <mat-form-field>
        <input matInput 
          [disabled]="!showHyprcolocSnpscoreTable"
          (keyup)="applyFilterHyprcolocSnpscore($event.target.value)" 
          placeholder="Filter">
      </mat-form-field>
    </div>
    <!-- loading spinner -->
    <div 
      class="d-flex justify-content-center" 
      *ngIf="!showHyprcolocSnpscoreTable && !hyprcolocSnpscoreWarningMessage">
      <mat-spinner></mat-spinner>
    </div>
    <!-- show warning message if no Hyprcoloc snpscore data is returned -->
    <div 
      id="hyprcoloc-snpscore-warning"
      class="ml-2 mr-2 alert alert-warning show text-center" 
      role="alert"  
      *ngIf="hyprcolocSnpscoreWarningMessage">
      No Hyprcoloc snpscore calculation results. Please check input data files and calculation parameters.
    </div>
    <!-- x-scrollable table container -->
    <div class="ml-2 mr-2 hyprcoloc-snpscore-details-table-container" *ngIf="showHyprcolocSnpscoreTable">
      <table class="hyprcoloc-snpscore-details-table" mat-table [dataSource]="dataSourceHyprcolocSnpscore" matSortStart="desc">
        <!--- Note that these columns can be defined in any order.
              The actual rendered columns are set as a property on the row definition" -->

        <!-- rsnum Column -->
        <ng-container matColumnDef="rsnum">
          <th mat-header-cell *matHeaderCellDef> RS Number </th>
          <td mat-cell *matCellDef="let hyprcolocSnpscore">{{hyprcolocSnpscore.rsnum}}</td>
        </ng-container>
      
        <!-- snpscore Column -->
        <ng-container matColumnDef="snpscore">
          <th mat-header-cell *matHeaderCellDef> SNP Score </th>
          <td mat-cell *matCellDef="let hyprcolocSnpscore">{{hyprcolocSnpscore.snpscore}}</td>
        </ng-container>
      
        <!-- gene_id Column -->
        <ng-container matColumnDef="gene_id">
          <th mat-header-cell *matHeaderCellDef> Gene ID </th>
          <td mat-cell *matCellDef="let hyprcolocSnpscore">{{hyprcolocSnpscore.gene_id}}</td>
        </ng-container>
      
        <!-- gene_symbol Column -->
        <ng-container matColumnDef="gene_symbol">
          <th mat-header-cell *matHeaderCellDef> Gene Symbol </th>
          <td mat-cell *matCellDef="let hyprcolocSnpscore"> {{hyprcolocSnpscore.gene_symbol}} </td>
        </ng-container>
      
        <tr mat-header-row *matHeaderRowDef="displayedColumnsHyprcolocSnpscore" style="background: #8C97D4 !important;"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumnsHyprcolocSnpscore;"></tr>
      </table>

    </div>
      
    <mat-paginator #HyprcolocSnpscorePaginator [pageSizeOptions]="[10, 20, 50, 100]" showFirstLastButtons style="background: #E8E8E8 !important;"></mat-paginator>
    
    <div class="ml-4 mb-4 hyprcoloc-snpscore-details-table" style="color: #0000EE; text-decoration: underline; cursor: pointer;">
      <a (click)="downloadHyprcolocSnpscoreTable()" 
        *ngIf="showHyprcolocSnpscoreTable">
        Download Hyprcoloc SNP Scores Table
      </a>
    </div>

  </div>

  <br>

</div>